<nav class="container bg-white/80 backdrop-blur nv-shadow rounded-2xl p-3 flex items-center justify-between mb-8 border border-white/20 hover:shadow-xl transition-all duration-300">
    <!-- Logo -->
    <div class="flex items-center gap-2 flex-shrink-0">
        <a href="/" class="flex items-center gap-2 hover:opacity-80 transition-opacity" style="text-decoration: none;">
            <img src="{{ url_for('static', filename='logo-transparent.svg') }}" 
                 alt="TikZ to SVG Logo" 
                 class="rounded-lg shadow-sm"
                 style="width: 30px; height: 30px; object-fit: contain;">
            <span class="text-lg font-bold text-gray-800">TikZ to SVG</span>
        </a>
    </div>

    <!-- Menu - Desktop -->
    <div class="hidden md:flex flex-grow mx-4 justify-center">
        <ul id="main-menu" class="list-unstyled p-0 m-0 d-flex align-items-center gap-3 font-medium text-gray-700">
            <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
                <a href="/" class="block text-base" style="line-height: 1;">Trang chủ</a>
                <div class="menu-underline"></div>
            </li>
            {% if current_user.is_authenticated %}
            <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
                <a href="/profile/{{ current_user.id }}/settings" class="block text-base" style="line-height: 1;">Hồ sơ</a>
                <div class="menu-underline"></div>
            </li>
            <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
                <a href="/profile/{{ current_user.id }}/svg-files" class="block text-base" style="line-height: 1;">File SVG</a>
                <div class="menu-underline"></div>
            </li>
            <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
                <a href="/profile/{{ current_user.id }}/followed-posts" class="block text-base" style="line-height: 1;">Bài đăng</a>
                <div class="menu-underline"></div>
            </li>
            {% endif %}
        </ul>
    </div>

    <!-- Avatar/User or Login & Hamburger -->
    <div class="flex items-center gap-2 flex-shrink-0">
        {% if current_user.is_authenticated %}
            <div class="flex items-center gap-2">
                <a href="/profile/{{ current_user.id }}/settings" class="flex items-center gap-2 bg-gray-100 px-2 py-1.5 rounded-lg border border-gray-300 hover:bg-gray-200 hover:border-gray-400 transition-all duration-200 cursor-pointer">
                    {% if current_avatar %}
                        <img src="{{ url_for('static', filename='avatars/' ~ current_avatar) }}" 
                             alt="Avatar" class="w-6 h-6 rounded-full"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    {% endif %}
                    {% if not current_avatar %}
                        <div class="w-6 h-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xs">
                            {{ current_user_email[0].upper() if current_user_email else 'U' }}
                        </div>
                    {% endif %}
                    <span class="text-xs font-medium text-gray-700 flex items-center gap-1">
                        {{ current_username or (current_user_email.split('@')[0] if current_user_email) }}
                        {% if current_identity_verified %}
                            <img src="{{ url_for('static', filename='identity-verification-icon.svg') }}" alt="Verified" style="width: 14px; height: 14px; vertical-align: middle;" />
                        {% endif %}
                    </span>
                </a>
                <button id="logout-btn" class="hidden md:block bg-gradient-to-r from-red-400 to-red-600 text-white px-3 py-1.5 rounded-xl shadow hover:scale-105 transition-all duration-200 font-semibold text-xs border-0 hover:from-red-500 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-red-300 focus:ring-opacity-50">Đăng xuất</button>
            </div>
        {% else %}
            <button class="hidden md:block bg-gradient-to-r from-blue-400 to-yellow-400 text-white px-3 py-1.5 rounded-xl shadow hover:scale-105 transition-all duration-200 font-semibold text-sm border-0 hover:from-blue-500 hover:to-yellow-500 focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-opacity-50" onclick="window.location.href='/login/google'">Đăng nhập</button>
        {% endif %}
        <!-- Hamburger (mobile) -->
        <button id="menu-toggle" class="md:hidden p-1.5 rounded-lg hover:bg-blue-100 transition">
            <i class="fas fa-bars text-lg"></i>
        </button>
    </div>
</nav>

<!-- Scrollable Menu - Mobile -->
<div id="scrollable-menu" class="md:hidden container mb-8">
    <ul id="scrollable-menu-list" class="list-unstyled p-0 m-0 d-flex align-items-center gap-3 font-medium text-gray-700 px-3">
        <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
            <a href="/" class="block text-base" style="line-height: 1;">Trang chủ</a>
            <div class="menu-underline"></div>
        </li>
        {% if current_user.is_authenticated %}
        <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
            <a href="/profile/{{ current_user.id }}/settings" class="block text-base" style="line-height: 1;">Hồ sơ</a>
            <div class="menu-underline"></div>
        </li>
        <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
            <a href="/profile/{{ current_user.id }}/svg-files" class="block text-base" style="line-height: 1;">File SVG</a>
            <div class="menu-underline"></div>
        </li>
        <li class="menu-item relative px-2 py-1 cursor-pointer transition hover:text-blue-600">
            <a href="/profile/{{ current_user.id }}/followed-posts" class="block text-base" style="line-height: 1;">Bài đăng</a>
            <div class="menu-underline"></div>
        </li>
        {% endif %}
    </ul>
    
</div>

<!-- Mobile Menu -->
<div id="mobile-menu" class="fixed top-0 left-0 w-full h-full bg-black/50 z-400 hidden">
    <div class="absolute right-0 top-0 w-60 bg-white h-full nv-shadow flex flex-col p-6 gap-3">
        <button id="close-menu" class="self-end text-2xl text-gray-500 hover:text-blue-400">
            <i class="fas fa-times"></i>
        </button>
        <a href="/" class="py-2 px-3 rounded-lg text-gray-700 font-medium hover:bg-blue-100 transition">Trang chủ</a>
        {% if current_user.is_authenticated %}
        <a href="/profile/{{ current_user.id }}/settings" class="py-2 px-3 rounded-lg text-gray-700 font-medium hover:bg-blue-100 transition">Hồ sơ</a>
        <a href="/profile/{{ current_user.id }}/svg-files" class="py-2 px-3 rounded-lg text-gray-700 font-medium hover:bg-blue-100 transition">File SVG</a>
        <a href="/profile/{{ current_user.id }}/followed-posts" class="py-2 px-3 rounded-lg text-gray-700 font-medium hover:bg-blue-100 transition">Bài đăng</a>
        <button id="mobile-logout-btn" class="logout-btn bg-gradient-to-r from-red-400 to-red-600 text-white px-4 py-2 rounded-xl shadow font-semibold mt-2 text-center border-0 w-full hover:from-red-500 hover:to-red-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-300 focus:ring-opacity-50">Đăng xuất</button>
        {% else %}
        <button class="login-btn bg-gradient-to-r from-blue-600 to-blue-800 text-white px-4 py-2 rounded-xl shadow-lg font-semibold mt-8 hover:from-blue-700 hover:to-blue-900 transition-all duration-200" onclick="window.location.href='/login/google'">Đăng nhập</button>
        {% endif %}
    </div>
</div>


