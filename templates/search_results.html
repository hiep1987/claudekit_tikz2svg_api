{% extends "base.html" %}

{# Configuration flags #}
{% set include_highlight_js = true %}
{% set include_codemirror = true %}
{% set include_file_card = true %}
{% set include_navigation = true %}
{% set include_login_modal = true %}
{% set include_navbar = true %}

{# Page Title #}
{% block title %}K·∫øt qu·∫£ t√¨m ki·∫øm - TikZ to SVG{% endblock %}

{# Page-specific CSS #}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/search_results.css', v='1.0') }}">
{% endblock %}

{# Page Content #}
{% block content %}
<!-- Search Results Header -->
<div class="page-container search-header-container">
    <div class="search-results-header">
        <h1>üîç K·∫øt qu·∫£ t√¨m ki·∫øm</h1>
        <div class="search-query">T·ª´ kh√≥a: "{{ search_query }}"</div>
        <div class="results-count">
            T√¨m th·∫•y {{ results_count }} k·∫øt qu·∫£
        </div>
        <a href="/" class="back-to-home">
            <i class="fas fa-arrow-left"></i> V·ªÅ trang ch·ªß
        </a>
    </div>
</div>

<!-- Search Results Section -->
<div class="files-section-container page-container files-section" data-is-owner="{{ 'true' if logged_in else 'false' }}">
    <div id="search-results-container" class="files-grid">
        {% if search_results %}
            {% for file in search_results %}
                {% include 'partials/_file_card.html' %}
            {% endfor %}
        {% else %}
            <div class="no-files">
                <div class="no-files-icon">üîç</div>
                <h4>Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£</h4>
                <p>Kh√¥ng c√≥ ·∫£nh SVG n√†o kh·ªõp v·ªõi t·ª´ kh√≥a "{{ search_query }}"</p>
                <p class="back-link">
                    <a href="/">‚Üê Quay v·ªÅ trang ch·ªß</a>
                </p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{# Page-specific JavaScript #}
{% block extra_js %}
<!-- External JavaScript Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/latex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/stex/stex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/display/placeholder.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Application JavaScript -->
<script src="{{ url_for('static', filename='js/navigation.js', v='1.0') }}"></script>
<script>
    // Set login status from server
    var isLoggedIn = {% if logged_in %}true{% else %}false{% endif %};
    
    // Initialize window.appState for file_card.js compatibility
    window.appState = {
        loggedIn: isLoggedIn,
        userEmail: {% if user_email %}'{{ user_email }}'{% else %}null{% endif %}
    };
</script>
<script src="{{ url_for('static', filename='js/file_card.js', v='1.2') }}"></script>
{% endblock %}