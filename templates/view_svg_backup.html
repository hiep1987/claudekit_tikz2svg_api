{% extends "base.html" %}

{# Configuration flags #}
{% set include_highlight_js = true %}
{% set include_codemirror = true %}
{% set include_file_card = true %}
{% set include_navigation = true %}
{% set include_login_modal = true %}
{% set include_navbar = true %}

{# Page Title #}
{% block title %}Xem SVG - {{ display_name %}{% endblock %}
{# Custom Meta Tags #}
{% block meta %}
<meta name="description" content="Xem v√† chia s·∫ª h√¨nh TikZ SVG tr·ª±c tuy·∫øn - {{ display_name }}">
<meta name="keywords" content="TikZ, SVG, LaTeX, vector graphics, view, share">
<meta name="author" content="TikZ to SVG">
<meta name="robots" content="index, follow">
<meta property="og:title" content="TikZ to SVG - {{ display_name }}" />
<meta property="og:type" content="website" />
<meta property="og:image" content="{{ request.host_url.rstrip('/') ~ png_url }}" />
<meta property="og:url" content="{{ request.host_url.rstrip('/') ~ url_for('view_svg', filename=filename) }}" />
<meta property="og:description" content="Xem v√† chia s·∫ª h√¨nh TikZ SVG tr·ª±c tuy·∫øn." />
<meta property="og:locale" content="vi_VN">
{% endblock %}
    <!-- Highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    
    <!-- Programming Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Fira+Code:wght@400;500;600&family=Source+Code+Pro:wght@400;500;600&family=Inconsolata:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Navigation CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navigation.css', v='1.0') }}">
    <!-- Login Modal CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login_modal.css', v='1.0') }}">
    
    <!-- View SVG Page CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/view_svg.css', v='1.0') }}">
</head>
<body data-is-logged-in="{% if user_email %}true{% else %}false{% endif %}" data-set-next-url="{{ url_for('set_next_url') }}">
    <!-- TikZ App Container Scope -->
    <div class="tikz-app">
    
    {% include 'partials/_navbar.html' %}
    
    <!-- View SVG Section -->
    <div class="page-container">
        <h2>{{ display_name }}</h2>
        <div id="view-mode-row">
            <div class="view-col">
                <div id="view-svg-preview">
                    <img id="view-svg-img" src="{{ svg_url }}" alt="Xem tr∆∞·ªõc h√¨nh ·∫£nh SVG - {{ display_name }}" aria-describedby="svg-description">
                </div>
                <div id="view-svg-actions">
                    <button id="view-copy-link-btn" class="view-action-btn" aria-label="Sao ch√©p li√™n k·∫øt ƒë·∫øn file SVG n√†y">üîó Copy Link</button>
                    <button id="view-download-svg-btn" class="view-action-btn view-download-btn" aria-label="T·∫£i xu·ªëng file SVG">üì• T·∫£i xu·ªëng SVG</button>
                </div>
            </div>
            <div class="view-col">
                <div class="actions-header">
                    <h4 class="actions-title">C√°c thao t√°c</h4>
                    <div class="actions-list">
                        <button id="view-back-to-edit-btn" aria-label="Quay v·ªÅ trang ch·ªânh s·ª≠a code TikZ">‚Ü©Ô∏è Quay v·ªÅ ch·ªânh s·ª≠a code TikZ</button>
                    </div>
                </div>
                <div id="view-export-section">
                    <div class="export-section">
                        <h4>Xu·∫•t ·∫£nh PNG/JPEG</h4>
                        <form id="view-export-form" class="export-form">
                            <div class="export-pair">
                                <label for="view-export-format" class="export-label">ƒê·ªãnh d·∫°ng:</label>
                                <select id="view-export-format" class="export-input export-select">
                                    <option value="png">PNG</option>
                                    <option value="jpeg">JPEG</option>
                                </select>
                            </div>
                            <div class="export-pair">
                                <label for="view-export-dpi" class="export-label">DPI:</label>
                                <input type="number" id="view-export-dpi" min="1" class="export-input export-number" placeholder="Auto">
                            </div>
                            <div class="export-pair">
                                <label for="view-export-width" class="export-label">Width (px):</label>
                                <input type="number" id="view-export-width" min="1" class="export-input export-number" placeholder="Auto">
                            </div>
                            <div class="export-pair">
                                <label for="view-export-height" class="export-label">Height (px):</label>
                                <input type="number" id="view-export-height" min="1" class="export-input export-number" placeholder="Auto">
                            </div>
                            <div class="export-btn-group">
                                <button id="view-export-btn" type="button" class="export-btn" aria-label="T·∫£i xu·ªëng file ·∫£nh PNG ho·∫∑c JPEG">T·∫£i xu·ªëng</button>
                            </div>
                        </form>
                        <div id="view-export-msg" class="export-msg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class='site-footer'>¬© 2024 TikZ2SVG - All rights reserved.</footer>

    {% include 'partials/_login_modal.html' %}

    <!-- Inject TikZ code as JSON to avoid inline Jinja inside JS -->
    <script id="tikz-code-json" type="application/json">{{ tikz_code|default("")|tojson|safe }}</script>

    </div> <!-- End .tikz-app -->

    <!-- External JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/latex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/stex/stex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/display/placeholder.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application JavaScript -->
    <script src="{{ url_for('static', filename='js/navigation.js', v='1.0') }}"></script>
    <script src="{{ url_for('static', filename='js/view_svg.js', v='1.0') }}"></script>
</body>
</html> 